\documentclass{scrreprt}

% Equations
\usepackage{amsmath}

% List customization
\usepackage[inline]{enumitem}

% They are all over the place
\usepackage{todonotes}

% Diagrams
\usepackage{tikz}
\usetikzlibrary{arrows,positioning}

% Appendices
\usepackage[header,title,titletoc]{appendix}
\renewcommand{\appendixname}{Appendix}

% License
\usepackage[
    type={CC},
    modifier={by-sa},
    version={3.0},
]{doclicense}

% Add bibliography to TOC
\usepackage[nottoc,numbib]{tocbibind}

% Sane datestamps
\usepackage[yyyymmdd]{datetime}
\renewcommand{\dateseparator}{--}

% Math symbols
\usepackage{amssymb}

% Haskell code highlighting
\usepackage{minted}
\newenvironment{code}{\VerbatimEnvironment\begin{minted}{haskell}}{\end{minted}}

% Include images
\usepackage{graphics}

% No new page on chapters
\usepackage{etoolbox}
\makeatletter
\patchcmd{\scr@startchapter}{\if@openright\cleardoublepage\else\clearpage\fi}{}{}{}
\makeatother

\begin{document}

\title{Supporting Competent Authorities in the Implementation of the NIS
Directive for Safety-Critical Industries}
\subtitle{Modelling through attack-defense trees}
\author{Uma Zalakain \\ \href{mailto:2423394z@student.gla.ac.uk}{2423394z@student.gla.ac.uk}}

{\let\newpage\relax\maketitle}
\doclicenseThis
\newpage

\pagenumbering{roman}
\setcounter{tocdepth}{2}
\tableofcontents
\newpage
\pagenumbering{arabic}

\chapter{Introduction}

The EU directive on the security of Networks and Information Systems (NIS) has
been integrated into UK law. This directive aims to improve the reliability and
security of those network and information systems that are essential to the
economy, society and individual's
welfare.\footnote{\url{https://www.ncsc.gov.uk/guidance/introduction-nis-directive}}

The NIS directive does not require Operators of Essential Services (OES) to
conform to a particular set of fixed rules. Instead, it hands the responsibility
of oversight to the relevant Competent Authority (CA). The NIS directive
postulates 14 general
principles\footnote{\url{https://www.ncsc.gov.uk/guidance/table-view-principles-and-related-guidance}}
-- CAs are strongly
encouraged\footnote{\url{https://www.gov.uk/government/publications/nis-regulations-guidance-for-competent-authorities}}
to use the Cyber Assessment
Framework\footnote{\url{https://www.ncsc.gov.uk/guidance/nis-directive-cyber-assessment-framework}}
to evaluate whether OES follow them. Depending on the sector, a CA may issue
more specific guidance. One such example is the guidance for Cyber Security for
Industrial Automation and Control
Systems\footnote{\url{http://www.hse.gov.uk/foi/internalops/og/og-0086.pdf}}
issued by the Health and Safety Executive.

\section{Contributions}

In this report I present a Haskell library capable of \textbf{modelling},
\textbf{rendering}, finding \textbf{minimal cutsets} and performing
\textbf{quantitative analysis} on attack defense trees.

I then demonstrate how a CA might use this tool to guide an asses an OES by
performing a case analysis on the provision of the top-level domain \texttt{.uk}
by Nominet\footnote{\url{https://nominet.uk}} -- where Ofcom is the competent
authority as the designated regulator for digital infrastructure.

Concretely, the library eases the evaluation of the following points of the
Cyber Assessment Framework:

\todo{revise these are met in evaluation}
\begin{description}
    \item [A2a]
        \begin{itemize}
            \item Your organisational process ensures that security risks to
                networks and information systems relevant to essential services
                are identified, analysed, prioritised, and managed.
            \item Your approach to risk is focused on the possibility of
                disruption to your essential service, leading to a detailed
                understanding of how such disruption might arise as a
                consequence of possible attacker actions and the security
                properties of your networks and information systems.
            \item The output from your risk management process is a clear set of
                security requirements that will address the risks in line with
                your organisational approach to security.
        \end{itemize}

    \item [B1a]
        \begin{itemize}
            \item Your systems are designed so that they remain secure even when
                user security policies and processes are not always followed.
        \end{itemize}
\end{description}

\chapter{A Haskell library for attack defense trees}

\section{Attack defense trees}

Fault trees were first introduced as a graphical and logical tool for modelling
the way in which basic events interact to lead to an undesired behaviour
\cite[IV.1]{Vesely1981}. They are therefore useful in safety-critical systems.
They consist of nodes and leafs: each node is a logical gate; each leaf a basic
event. This structure makes fault trees attractive for quantitative evaluation.
It is important to note that all basic events in a fault tree \textit{must} be
unique and independent. If not the case, every directed acyclic graph
representing a fault model can be rewritten as a fault tree.  \todo{citation
needed}

Attack trees take the idea of fault trees and adapt it to model attack scenarios
in security-critical systems \cite{Schneier1999} \cite{Brooke2003}
\cite{NaiFovino2009}: an attacker's objective (at the root of the tree) is
repeatedly refined into subgoals connected by logical gates. Yet, this model is
unable to represent any defensive measure.

Attack defense trees (ADTs) extend attack trees by introducing nodes that
represent defensive measures \cite{KordyFoundations}. Every node is thus an
action of either the attacker or the defender: interactive scenarios can be
represented.  As with fault trees, refinements can either be disjunctive or
conjunctive. To allow a quantitative evaluation of ADTs, nodes have to be
independent of each other -- alternative proposals relying on DAGs exist, but
are more complex \cite{KordyDAG}.

\todo{More on the technique itself?}

\begin{figure}[h]
    \label{example-adt}
    \centering
    \includegraphics[width=\textwidth]{bankaccount}
    \caption{Example attack defense tree generated by ADTrees. Red nodes
    represent the attacker's actions, green nodes the defendant's. Basic events
    contain multiple attributes for quantitative analysis.}
\end{figure}

% TODO: relate to NIS: CAF points
%   IMPORTANT: How attack defense trees help

\section{ADTrees}

\textit{ADTrees}\footnote{\url{https://github.com/umazalakain/adtrees}}
is a small Haskell library that implements attack defense trees. Its main goals
are:

\begin{description}
    \item [Small and simple]
    \item [Extendable]
    \item [Flexible analysis]
    \item [Aid decision making]
    \item [Be visualised]
\end{description}

\footnote{\url{https://github.com/tomahawkins/fault-tree}}
\footnote{\url{https://github.com/tahti/ADTool2}}
\cite{KordyTool}

\subsection{Tree modelling}

\begin{code}
data Player = A | D deriving (Show, Eq)
data Event a 
    = Basic Player Name a
    | And   Player Name [Event a]
    | Or    Player Name [Event a]
    deriving (Show, Eq)
\end{code}

Each node can be of type \texttt{Or}, \texttt{And} or \texttt{Basic}. Every node
has an associated player (\texttt{A} for attacker; \texttt{D} for defender) and
text. \texttt{Or} and \texttt{And} nodes contain subtrees, while \texttt{Basic}
nodes contain attribute data. \todo{colors}

The example ADT in Figure \ref{example-adt} can be represented as follows:

\begin{code}
Or A "Bank Account" [
    And A "ATM" [
        Or A "PIN" [
            Basic A "Eavesdrop" (0.01, 0),
            And A "Find Note" [
                Basic D "Memorize" (0.80, 0)],
            Basic A "Force" (0.01, 1)],
        Basic A "Card" (0.1, 1)],
    And A "Online" [
        Or A "Password" [
            Basic A "Phishing" (0.90, 0),
            Basic A "Key logger" (0.20, 0.5)],
        Basic A "User name" (0.90, 0),
        Or D "2nd Auth Factor" [
            Basic D "Key Fobs" (0.01, 0),
            Basic D "PIN Pad" (0.01, 0),
            Or A "Malware" [
                Basic A "Browser" (0.20, 0.5),
                Basic A "OS" (0.20, 0.5)]]]]
\end{code}

\subsection{Quantitative analysis}
Generalised algebra \cite{KordyQuantitative}

\begin{code}

-- Semantics for a given player
data PSemantics a = MkPSemantics
    { plus  :: a -> a -> a
    , zero  :: a
    , times :: a -> a -> a
    , one   :: a
    , minus :: a -> a
    }

-- Semantics for all players
type Semantics a = Player -> PSemantics a
\end{code}

\begin{code}
probability :: Semantics Rational
probability _ = MkPSemantics
    { plus  = (+)
    , zero  = 0
    , times = (*)
    , one   = 1
    , minus = (1 -)
    }

difficulty :: Semantics Rational
difficulty A = MkPSemantics
    { plus  = min
    , zero  = 1
    , times = max
    , one   = 0
    , minus = (1 -)
    }
difficulty D = MkPSemantics
    { plus  = max
    , zero  = 0
    , times = min
    , one   = 1
    , minus = (1 -)
    }
\end{code}

\subsection{Minimual cutsets}
\subsection{Visualisation}
\chapter{Evaluation}

\begin{figure}[h]
    \label{dns-transactions}
    \centering
    \includegraphics[width=\paperheight, angle=90]{dns}
    \caption{}
\end{figure}

% https://tools.ietf.org/html/rfc3833
% Showcase the tool with an example
% Underline how it helps implementing NIS
% We need to conduct some kind of experiment

% https://www.ofcom.org.uk/phones-telecoms-and-internet/information-for-industry/guidance-network-information-systems-regulations
% https://www.ncsc.gov.uk/information/active-cyber-defence-one-year
% https://www.theregister.co.uk/2017/08/17/uks_internet_operator_nominet_goes_dark/

\chapter{Results}

\chapter{Conclusions}

\bibliographystyle{apalike}
\bibliography{bibliography}

\newpage
\begin{appendices}
% Only display section titles in the TOC
\addtocontents{toc}{\protect\setcounter{tocdepth}{1}} 

\chapter{Source code}
% Where to obtain it
% How to install it
% A listing

\end{appendices}

\end{document}
